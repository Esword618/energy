<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>bind-event</title>
    <style>
        button {
            margin: 5px;
        }
    </style>
    <script type="application/javascript">


        let testObjectDefine = {object: {}};
        (function () {
            const obj = {
                name: "_island",
                age: 18,
                subobj: {
                    objName: "sssss",
                    fff: 123
                },
                cccc:["aaa","fff",123],
            };

            const objProxy = new Proxy(obj, {
                // 获取值时的捕获器
                get: function (target, key) {
                    console.log(`监听到了${key}被获取值`);
                    return target[key];
                },
                // 设置值时的捕获器
                set: function (target, key, newValue) {
                    console.log(`监听到了${key}被设置值`);
                    target[key] = newValue;
                }
            });

            console.log(objProxy.subobj.objName);
            console.log(objProxy.cccc[0]);


            Object.defineProperties(testObjectDefine, {
                key1: {
                    id: 333333,
                    get() {
                        msg('key1 get', this.id);
                        return 'key1Value';
                    },
                    set(v) {
                        msg('key1 set', v);
                    }
                },
                key2: {
                    id: 111111,
                    get() {
                        msg('key2 get', this.id);
                        return 'key2Value';
                    },
                    set(v) {
                        msg('key2 set', v);
                    }
                },
                key3: {
                    id: 2222222,
                    get() {
                        msg('key3 get', this.id);
                        return function () {
                            msg('function')
                            return "函数返回值"
                        };
                    },
                    set(v) {
                        msg('key3 set', v);
                    }
                }
            });
            Object.defineProperty(testObjectDefine.object, "myparam", {
                get() {
                    msg('get myparam');
                    return 'myparamValue';
                },
                set(v) {
                    msg('set myparam');
                }
            });
        })();
        const energya = new Proxy(energy, {
            // 获取值时的捕获器
            get: function (target, key) {
                console.log(`监听到了${key}被获取值`);
                return target[key];
            },
            // 设置值时的捕获器
            set: function (target, key, newValue) {
                console.log(`监听到了${key}被设置值`);
                target[key] = newValue;
            }
        });

        function testDefine() {
            //msg(energya.myparam)
            msg(testObjectDefine.key1)
            msg(testObjectDefine.key2)
            msg(testObjectDefine.key3())
            msg(testObjectDefine.object.myparam)
        }
    </script>
</head>
<body style="margin: 0px;padding: 0px;">
<p>
<h3 style="-webkit-app-region: drag;">bind</h3></p>
<p><a target="_blank" href="bind-event.html">open</a></p>
<p>
    自动执行时间/毫秒: <input id="time" value="0">
    <br>
    <button onclick="testDefine()">testDefine</button>

</p>
<p id="msgHtml"></p>
</body>
<script type="application/javascript">
    let msgHtml = document.getElementById("msgHtml");

    function msg(...vvv) {
        let str = msgHtml.innerHTML;
        for (let i = 0; i < vvv.length; i++) {
            str = str + "  " + vvv[i];
        }
        str += "<br>";
        msgHtml.innerHTML = str;
    }

    function clearMsg() {
        msgHtml.innerHTML = "";
    }

    msg("ipc-event: 页面加载完成...");
</script>
</html>